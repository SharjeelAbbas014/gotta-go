(this["webpackJsonpgotta-go"]=this["webpackJsonpgotta-go"]||[]).push([[0],{14:function(e,t,a){e.exports=a.p+"static/media/loading.9dc92fc6.gif"},15:function(e,t,a){e.exports=a.p+"static/media/back.4d0880fb.svg"},31:function(e,t,a){e.exports=a(55)},36:function(e,t,a){},38:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),s=a.n(c);a(36),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(16),u=a(7),l=a(2),o=a.n(l),m=a(5),d=a(3),h=a(14),f=a.n(h),p=(a(22),a(23),a(38),a(27)),g=a(28),b=a(13),v=a.n(b),E=(a(41),a(43),{apiKey:"AIzaSyASNXhfa9YOFQUh6sb0JkaFFtF3GxpYxgY",authDomain:"gotta-go-4cbcb.firebaseapp.com",databaseURL:"https://gotta-go-4cbcb.firebaseio.com",projectId:"gotta-go-4cbcb",storageBucket:"gotta-go-4cbcb.appspot.com",messagingSenderId:"632875817321",appId:"1:632875817321:web:8a14181acd4303749505f8",measurementId:"G-P3YC46LM98"}),w=new(function(){function e(){var t=this;Object(p.a)(this,e),this.userExist=function(){var e=Object(m.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.db.collection("users").get();case 2:return n=e.sent,r=n.docs.map((function(e){return e.data().email})).includes(a),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v.a.initializeApp(E),this.auth=v.a.auth(),this.db=v.a.firestore()}return Object(g.a)(e,[{key:"login",value:function(e,t){return this.isLogin=!0,this.auth.signInWithEmailAndPassword(e,t)}},{key:"logout",value:function(){return this.isLogin=!1,this.auth.signOut()}},{key:"register",value:function(){var e=Object(m.a)(o.a.mark((function e(t,a,n){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.createUserWithEmailAndPassword(a,n);case 2:return r=e.sent,c={email:r.user.email,name:t},e.next=6,this.db.collection("users").doc(a).set(c);case 6:return e.abrupt("return",this.auth.currentUser.updateProfile({displayName:t}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"userLogin",value:function(){return this.auth.onAuthStateChanged((function(e){if(null===e)return!1})),!0}},{key:"getUserChatList",value:function(e,t){var a=this;this.auth.onAuthStateChanged(function(){var n=Object(m.a)(o.a.mark((function n(r){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null!==r&&a.db.collection("chats").where("users","array-contains",r.email).onSnapshot(function(){var a=Object(m.a)(o.a.mark((function a(n){var c;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=n.docs.map((function(e){return e.data()})),a.next=3,t(c);case 3:return a.next=5,e(r.email);case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"addMessage",value:function(e,t,a){this.db.collection("chats").doc(a).update({messages:v.a.firestore.FieldValue.arrayUnion({sender:e,message:t,timestamp:Date.now()}),receiverHasRead:!1})}},{key:"hasRead",value:function(e){this.db.collection("chats").doc(e).update({receiverHasRead:!0})}},{key:"newChatSubmit",value:function(e,t,a){var n={receiverHasRead:!1,users:[t,a.sendTo],messages:[{message:a.message,sender:t}]};console.log(n),this.db.collection("chats").doc(e).set(n)}}]),e}()),C=Object(u.e)((function(e){var t=Object(n.useState)(""),a=Object(d.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(""),u=Object(d.a)(i,2),l=u[0],h=u[1],p=Object(n.useState)(!1),g=Object(d.a)(p,2),b=g[0],v=g[1],E=function(){var t=Object(m.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(!0),t.prev=1,t.next=4,w.login(c,l);case 4:v(!1),e.history.replace("/dashboard"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),v(!1),alert(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{id:"signBack"},b?r.a.createElement("div",{className:"loading"},r.a.createElement("img",{alt:"Loading",src:f.a})):null,r.a.createElement("div",{id:"form"},r.a.createElement("h2",null,"Gotta GO!",r.a.createElement("span",{role:"img",onSubmit:function(e){return e.preventDefault()&&!1},"aria-label":"RunEmoji"},"\ud83c\udfc3\u200d\u2642\ufe0f")),r.a.createElement("h3",null,"Sign In"),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"email",type:"email",className:"validate",required:!0,autoFocus:!0,value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("label",{htmlFor:"email"},"Enter Your Email")),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"password",type:"password",className:"validate",required:!0,value:l,onChange:function(e){return h(e.target.value)}}),r.a.createElement("label",{htmlFor:"password"},"Enter Your Password")),r.a.createElement("button",{className:"cusButton",type:"submit",onClick:E},"Login"),r.a.createElement("button",{className:"cusButton",id:"withGoogle",onClick:function(){e.history.replace("/signup")}},"Sign Up")))})),O=(a(49),function(e){console.log(e.chats.length);var t=function(){e.newChat(!0)},a=function(){e.signOut.logout(),e.history.replace("/login")},n=function(t){return t.messages[t.messages.length-1].sender===e.userEmail};return e.chats.length>0?r.a.createElement("div",{id:"chatList"},r.a.createElement("br",null),r.a.createElement("button",{id:"newChat",onClick:t},"Create New Chat"),r.a.createElement("div",{id:"ActualChat"},console.log("hell",e.selectedChatIndex),e.chats.map((function(t,a){return r.a.createElement("div",{onClick:function(){return e.selectChatFn(a)},className:"personName",id:e.selectedChatIndex===a?"selected":!1!==t.receiverHasRead||n(t)?"":"notRead"},r.a.createElement("h3",null,t.users.filter((function(t){return t!==e.userEmail}))[0].substring(0,20)),r.a.createElement("p",null,t.messages[t.messages.length-1].message.substring(0,20)))}))),r.a.createElement("button",{id:"signOut",onClick:a},"Sign Out!")):r.a.createElement("div",{id:"chatList"},r.a.createElement("br",null),r.a.createElement("button",{id:"newChat",onClick:t},"Create New Chat"),r.a.createElement("div",null,r.a.createElement("div",{className:"personName"},r.a.createElement("h3",null,"No Chats"))),r.a.createElement("button",{id:"signOut",onClick:a},"Sign Out!"))}),j=(a(50),a(15)),y=a.n(j),k=function(e){var t=e.chat,a=e.user,c=e.mobile,s=e.setSelectedChat,i=Object(n.useState)(!1),u=Object(d.a)(i,2),l=u[0],o=u[1];return Object(n.useEffect)((function(){var e=document.getElementById("chatView");e&&(console.log(e.scrollHeight),window.scrollTo(0,document.querySelector("#chatView").scrollHeight))}),[t]),void 0!==t?c?r.a.createElement("div",{id:"chatView"},r.a.createElement("div",{id:"backDiv"},r.a.createElement("img",{onClick:function(){s(null)},src:y.a})),t.messages.map((function(e,n){return l||o(!0),r.a.createElement("div",{className:e.sender===a?"myMsg":"otherMsg",id:n===t.messages.length-1?"last":""},r.a.createElement("div",null,r.a.createElement("p",null,e.message)))}))):r.a.createElement("div",{id:"chatView"},t.messages.map((function(e,n){return l||o(!0),r.a.createElement("div",{className:e.sender===a?"myMsg":"otherMsg",id:n===t.messages.length-1?"last":""},r.a.createElement("div",null,r.a.createElement("p",null,e.message)))}))):r.a.createElement("div",{id:"chatView"})},x=(a(51),function(e){var t=Object(n.useState)(""),a=Object(d.a)(t,2),c=a[0],s=a[1],i=function(){u(c)&&(e.submitMsgFn(c),document.getElementById("message").value="")},u=function(e){return e&&e.replace(/\s/g,"").length};return void 0!==e.chats?r.a.createElement("div",{id:"chatBox"},r.a.createElement("button",{onClick:i},"Send"),r.a.createElement("input",{onKeyUp:function(e){return function(e){13===e.keyCode&&i()}(e)},type:"text",id:"message",onChange:function(e){return s(e.target.value)},placeholder:"Type your Message"})):r.a.createElement("div",null)}),S=(a(52),function(e){var t=Object(n.useState)(""),a=Object(d.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(""),u=Object(d.a)(i,2),l=u[0],h=u[1],f=function(){var t=Object(m.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=v(),t.next=3,e.firebase.db.collection("chats").doc(a).get();case 3:return n=t.sent,t.abrupt("return",n.exists);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=function(){var t=Object(m.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,e.firebase.userExist();case 3:if(!t.sent){t.next=9;break}return t.next=7,f();case 7:t.sent?b():g();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){e.newChatSubmitFn({sendTo:l,message:c})},b=function(){return e.goToChatFn(v(),c)},v=function(){return[e.firebase.auth.currentUser.email,l].sort().join(":")};return r.a.createElement("div",{id:"createChat"},r.a.createElement("div",{id:"backDiv"},r.a.createElement("img",{onClick:function(){e.setNewChat(!1)},src:y.a})),r.a.createElement("div",{id:"form"},r.a.createElement("h2",null,"Create New Chat"),r.a.createElement("br",null),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{onChange:function(e){return h(e.target.value)},id:"email",type:"email",className:"validate",required:!0,autoFocus:!0}),r.a.createElement("label",{htmlFor:"email"},"Enter Your Email")),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{onChange:function(e){return s(e.target.value)},id:"message",type:"text",className:"validate",required:!0}),r.a.createElement("label",{htmlFor:"message"},"Enter Your Message")),r.a.createElement("button",{onClick:p,className:"cusButton"},"Send")))}),N=(a(53),function(e){var t=Object(n.useState)(null),a=Object(d.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(!1),u=Object(d.a)(i,2),l=u[0],h=u[1],f=Object(n.useState)(null),p=Object(d.a)(f,2),g=p[0],b=p[1],v=Object(n.useState)([]),E=Object(d.a)(v,2),C=E[0],j=E[1],y=Object(n.useState)(!1),N=Object(d.a)(y,2),F=N[0],I=N[1],B=window.innerWidth<=850,M=function(){h(!0),s(null)};Object(n.useEffect)((function(){w.getUserChatList(b,j)}),[]);var L=function(){var e=Object(m.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:I(!1),A(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){return[g,e].sort().join(":")},A=function(e){var t=Y(C[e].users.filter((function(e){return e!==g}))[0]);(function(e){return C[e].messages[C[e].messages.length-1]!==g})(e)&&w.hasRead(t)},R=function(e){var t=Y(C[c].users.filter((function(e){return e!==g}))[0]);w.addMessage(g,e,t),console.log(t)},U=function(){var e=Object(m.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(":"),r=C.find((function(e){return n.every((function(t){return e.users.includes(t)}))})),h(!1),e.next=5,c(C.indexOf(r));case 5:R(a);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),P=function(){var e=Object(m.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Y(t.sendTo),e.next=3,w.newChatSubmit(a,g,t);case 3:h(!1),s(C.length-1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return B?null===c?r.a.createElement("div",null,!0===F?r.a.createElement(S,{goToChatFn:U,newChatSubmitFn:P,setNewChat:I,firebase:w,mobile:B}):r.a.createElement(O,{history:e.history,newChatButtonFn:M,selectChatFn:L,signOut:w,chats:C,userEmail:g,selectedChatIndex:c,newChat:I})):r.a.createElement("div",null,!0===F?r.a.createElement(S,{goToChatFn:U,newChatSubmitFn:P,firebase:w}):l?null:r.a.createElement(k,{mobile:B,setSelectedChat:s,user:g,chat:C[c]}),r.a.createElement(x,{chats:C[c],submitMsgFn:R})):r.a.createElement("div",null,r.a.createElement(O,{history:e.history,newChatButtonFn:M,selectChatFn:L,signOut:w,chats:C,userEmail:g,selectedChatIndex:c,newChat:I}),!0===F?r.a.createElement(S,{goToChatFn:U,newChatSubmitFn:P,firebase:w}):l?null:r.a.createElement(k,{user:g,chat:C[c]}),r.a.createElement(x,{chats:C[c],submitMsgFn:R}))}),F=(a(54),Object(u.e)((function(e){var t=Object(n.useState)(""),a=Object(d.a)(t,2),c=a[0],s=a[1],u=Object(n.useState)(""),l=Object(d.a)(u,2),h=l[0],p=l[1],g=Object(n.useState)(""),b=Object(d.a)(g,2),v=b[0],E=b[1],C=Object(n.useState)(""),O=Object(d.a)(C,2),j=O[0],y=O[1],k=Object(n.useState)(!0),x=Object(d.a)(k,2),S=x[0],N=x[1],F=Object(n.useState)(!1),I=Object(d.a)(F,2),B=I[0],M=I[1];console.log(c);var L=function(){var t=Object(m.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(M(!0),h===j){t.next=5;break}N(!1),t.next=17;break;case 5:return N(!0),t.prev=6,t.next=9,w.register(v,c,h);case 9:M(!1),e.history.replace("/dashboard"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(6),M(!1),alert(t.t0.message);case 17:case"end":return t.stop()}}),t,null,[[6,13]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{id:"signBack"},B?r.a.createElement("div",{className:"loading"},r.a.createElement("img",{alt:"loading",src:f.a})):null,r.a.createElement("div",{id:"form"},r.a.createElement("h2",null,"Gotta GO!",r.a.createElement("span",{role:"img",onSubmit:function(e){return e.preventDefault()&&!1},"aria-label":"RunEmoji"},"\ud83c\udfc3\u200d\u2642\ufe0f")),r.a.createElement("h3",null,"Sign Up"),S?r.a.createElement("p",null):r.a.createElement("p",null,"Passwords Does Not Match"),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"email",type:"email",className:"validate",required:!0,autoFocus:!0,value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("label",{htmlFor:"email"},"Enter Your Email")),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"name",type:"text",className:"validate",required:!0,value:v,onChange:function(e){return E(e.target.value)}}),r.a.createElement("label",{htmlFor:"name"},"Enter Your Name")),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"password",type:"password",className:"validate",required:!0,value:h,onChange:function(e){return p(e.target.value)}}),r.a.createElement("label",{htmlFor:"password"},"Enter Your Password")),r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{id:"conPass",type:"password",className:"validate",required:!0,value:j,onChange:function(e){return y(e.target.value)}}),r.a.createElement("label",{htmlFor:"conPass"},"Confirm Your Password")),r.a.createElement("button",{className:"cusButton",type:"submit",onClick:L},"Register Me!"),r.a.createElement("p",null,"Already Have An Account?"),r.a.createElement(i.b,{to:"/Login"},"Sign In!")))}))),I=r.a.createElement(i.a,null,r.a.createElement("div",{id:"routingContainer"},r.a.createElement(u.a,{path:"/",exact:!0,component:C}),r.a.createElement(u.a,{path:"/login",component:C}),r.a.createElement(u.a,{path:"/signup",component:F}),r.a.createElement(u.a,{path:"/dashboard",component:N})));s.a.render(I,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.3611efbe.chunk.js.map